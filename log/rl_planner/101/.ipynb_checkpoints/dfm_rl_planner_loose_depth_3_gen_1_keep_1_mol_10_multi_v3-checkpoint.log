args:  Namespace(rl_model_path='results/rl_model_checkpoint/rl_model_checkpoint/general_replay_buffer_mol_logP_loose_101_best_reward.pth', conversational_LLM='dfm', planning_LLM='deepseek', fast_protein=False, cot=None, num_of_mol=10, task_id=101, constraint='loose', conversation_type='multi', planner='rl_planner', depth=3, num_generate=1, num_keep=1)
>>Sample 0
RL Suggestion 0: Replace Carbon Atom with Sulfonamide. 
Message 0: [{'role': 'system', 'content': 'You are a helpful chemistry expert with extensive knowledge of drug design. '}, {'role': 'user', 'content': 'Can you make molecule O=C(NC[C@H]1CCCO1)c1ccccc1N1CCCC1=O more soluble in water? The output molecule should be similar to the input molecule. You are suggested to do the modification according to the suggestion: Replace Carbon Atom with Sulfonamide.  Give me five molecules in SMILES only and list them using bullet points. No explanation is needed. '}]
AI answer 0:  * O=C(NC[C@H]1CCCO1)c1ccccc1N1CCCC1=O
* O=C(NC[C@H]1CCCO1)c1cc(S(N)(=O)=O)ccc1N1CCCC1=O
* O=C(NC[C@H]1CCCO1)c1cc(S(N)(=O)=O)ccc1N1CCCC1=NS(=O)(=O)c1ccccc1
* O=C(NC[C@H]1CCCO1)c1cc(S(N)(=O)=O)ccc1N1CCCC1=Nc1ccccc1S(=O)(=O)O
* O=C(NC[C@H]1CCCO1)c1cc(S(N)(=O)=O)ccc1N1CCCC1=Nc1cccc(C(=O)O)c1S(=O)(=O)O
Acc = 1/1
Hit Ratio = 1/1
----------------
>>Sample 1
RL Suggestion 0: Replace Carbon Atom with Sulfonamide. 
Message 0: [{'role': 'system', 'content': 'You are a helpful chemistry expert with extensive knowledge of drug design. '}, {'role': 'user', 'content': 'Can you make molecule Cn1ccc(C(=O)Nc2sc3c(c2C#N)CCC3)cc1=O more soluble in water? The output molecule should be similar to the input molecule. You are suggested to do the modification according to the suggestion: Replace Carbon Atom with Sulfonamide.  Give me five molecules in SMILES only and list them using bullet points. No explanation is needed. '}]
AI answer 0:  * Cn1ccc(C(=O)Nc2sc3c(c2C(N)=O)CCC3)c(S(N)(=O)=O)c1=O
* Cn1ccc(C(=O)Nc2sc3c(c2C#N)CCC3)c(S(N)(=O)=O)c1=O
* Cn1ccc(C(=O)Nc2sc3c(c2C(N)=O)CCCC3)c(S(N)(=O)=O)c1=O
* Cn1ccc(C(=O)Nc2sc3c(c2C(N)=O)CCCCC3)c(S(N)(=O)=O)c1=O
* Cn1ccc(C(=O)Nc2sc3c(c2C#N)CCCCC3)c(S(N)(=O)=O)c1=O
Acc = 2/2
Hit Ratio = 2/2
----------------
>>Sample 2
RL Suggestion 0: Replace Carbon Atom with Sulfonamide. 
Message 0: [{'role': 'system', 'content': 'You are a helpful chemistry expert with extensive knowledge of drug design. '}, {'role': 'user', 'content': 'Can you make molecule CCCCn1nc(C(=O)Nc2ccc(N3CCOCC3)nc2)ccc1=O more soluble in water? The output molecule should be similar to the input molecule. You are suggested to do the modification according to the suggestion: Replace Carbon Atom with Sulfonamide.  Give me five molecules in SMILES only and list them using bullet points. No explanation is needed. '}]
AI answer 0:  * CCCCNS(=O)(=O)c1ccc(C(=O)Nc2ccc(N3CCOCC3)nc2)nn1
* CCCCCS(=O)(=O)c1ccc(C(=O)Nc2ccc(N3CCOCC3)nc2)nn1
* CCCCCCS(=O)(=O)c1ccc(C(=O)Nc2ccc(N3CCOCC3)nc2)nn1
* CCCCCCCCNS(=O)(=O)c1ccc(C(=O)Nc2ccc(N3CCOCC3)nc2)nn1
* CCCCCCCCCCS(=O)(=O)c1ccc(C(=O)Nc2ccc(N3CCOCC3)nc2)nn1
Acc = 3/3
Hit Ratio = 3/3
----------------
>>Sample 3
RL Suggestion 0: Replace Carbon Atom with Sulfonamide. 
Message 0: [{'role': 'system', 'content': 'You are a helpful chemistry expert with extensive knowledge of drug design. '}, {'role': 'user', 'content': 'Can you make molecule CC[C@@](C)(NCC(=O)N(C)OC)c1nc(C)cs1 more soluble in water? The output molecule should be similar to the input molecule. You are suggested to do the modification according to the suggestion: Replace Carbon Atom with Sulfonamide.  Give me five molecules in SMILES only and list them using bullet points. No explanation is needed. '}]
AI answer 0:  * C[C@](C)(CC)c1nc(C)cs1
* C[C@](C)(CC)NC(=O)N1CCCC1
* C[C@](C)(CC)NC(=O)OCCOCCOCCNC(=O)[C@@](C)(CC)c1nccs1
* C[C@](C)(CC)NC(=O)OCCOCCOCCNC(=O)[C@@](C)(CC)c1nc(C)cs1
* C[C@](C)(CC)NC(=O)OCCOCCOCCNC(=O)OC(C)(C)C
RL Suggestion 0: Add a Guanidine. 
Message 0: [{'role': 'system', 'content': 'You are a helpful chemistry expert with extensive knowledge of drug design. '}, {'role': 'user', 'content': 'Can you make molecule CC[C@@](C)(NCC(=O)N(C)OC)c1nc(C)cs1 more soluble in water? The output molecule should be similar to the input molecule. You are suggested to do the modification according to the suggestion: Replace Carbon Atom with Sulfonamide.  Give me five molecules in SMILES only and list them using bullet points. No explanation is needed. '}, {'role': 'assistant', 'content': ' * C[C@](C)(CC)c1nc(C)cs1\n* C[C@](C)(CC)NC(=O)N1CCCC1\n* C[C@](C)(CC)NC(=O)OCCOCCOCCNC(=O)[C@@](C)(CC)c1nccs1\n* C[C@](C)(CC)NC(=O)OCCOCCOCCNC(=O)[C@@](C)(CC)c1nc(C)cs1\n* C[C@](C)(CC)NC(=O)OCCOCCOCCNC(=O)OC(C)(C)C'}, {'role': 'user', 'content': 'Your provided sequence C[C@](C)(CC)c1nc(C)cs1 could not achieve goal. You are suggested to edit the molecule according to the suggestion: You are suggested to do the modification according to the suggestion: Add a Guanidine. . Can you give me new molecules?'}]
AI answer 0: Here are five new molecules with added guanidine:
```python
C[C@](C)(CC)c1nc(CCN=C(N)N)cs1
C[C@](C)(CC)c1nc(CCNC(=N)N)cs1
C[C@](C)(CC)c1nc(CCN=C(N)N)c(S(N)(=O)=O)s1
C[C@](C)(CC)c1nc(CCNC(=N)N)c(S(N)(=O)=O)s1
C[C@](C)(CC)c1nc(CCN=C(N)N)c(N)s1
```
Note that the guanidine group can be added in different ways, such as being directly attached to the side chain of the amino acid or being part of a larger group attached to the side chain. Also, the position of the guanidine group can be varied, being before or after the amino acid residue.
Acc = 4/4
Hit Ratio = 4/4
----------------
>>Sample 4
RL Suggestion 0: Replace Carbon Atom with Sulfonamide. 
Message 0: [{'role': 'system', 'content': 'You are a helpful chemistry expert with extensive knowledge of drug design. '}, {'role': 'user', 'content': 'Can you make molecule C[C@H](NC(=O)CCN1c2ccccc2Sc2ccccc21)C1CC1 more soluble in water? The output molecule should be similar to the input molecule. You are suggested to do the modification according to the suggestion: Replace Carbon Atom with Sulfonamide.  Give me five molecules in SMILES only and list them using bullet points. No explanation is needed. '}]
AI answer 0:  * C[C@H](NC(=O)CCN1c2ccccc2Sc2ccccc21)C1CC1
* C[C@H](NC(=O)CCNS(=O)(=O)c1ccc(Cl)cc1)C1CC1
* C[C@H](NC(=O)CCNS(=O)(=O)c1ccc(C(F)(F)F)cc1)C1CC1
* C[C@H](NC(=O)CCNS(=O)(=O)c1ccc(N)cc1)C1CC1
* C[C@H](NC(=O)CCNS(=O)(=O)c1ccc(F)cc1)C1CC1
Acc = 5/5
Hit Ratio = 5/5
----------------
>>Sample 5
RL Suggestion 0: Replace Carbon Atom with Sulfonamide. 
Message 0: [{'role': 'system', 'content': 'You are a helpful chemistry expert with extensive knowledge of drug design. '}, {'role': 'user', 'content': 'Can you make molecule CCOC(=O)N1CCc2c(sc(NC(=O)c3ccc4c(c3)OCCO4)c2C(N)=O)C1 more soluble in water? The output molecule should be similar to the input molecule. You are suggested to do the modification according to the suggestion: Replace Carbon Atom with Sulfonamide.  Give me five molecules in SMILES only and list them using bullet points. No explanation is needed. '}]
AI answer 0:  * O=C(Nc1sc2c(c1C(N)=O)CN(C(=O)OCC)CC2)c1ccc2c(c1)OCCO2
* O=C(Nc1sc2c(c1C(N)=O)CN(S(=O)(=O)CC(C)(C)C)CC2)c1ccc2c(c1)OCCO2
* O=C(Nc1sc2c(c1C(N)=O)CN(S(=O)(=O)c1ccc(C)cc1)CC2)c1ccc2c(c1)OCCO2
* O=C(Nc1sc2c(c1C(N)=O)CN(S(=O)(=O)c1ccc(C(F)(F)F)cc1)CC2)c1ccc2c(c1)OCCO2
* O=C(Nc1sc2c(c1C(N)=O)CN(S(=O)(=O)N1CCCCC1)CC2)c1ccc2c(c1)OCCO2
RL Suggestion 0: Add a Guanidine. 
Message 0: [{'role': 'system', 'content': 'You are a helpful chemistry expert with extensive knowledge of drug design. '}, {'role': 'user', 'content': 'Can you make molecule CCOC(=O)N1CCc2c(sc(NC(=O)c3ccc4c(c3)OCCO4)c2C(N)=O)C1 more soluble in water? The output molecule should be similar to the input molecule. You are suggested to do the modification according to the suggestion: Replace Carbon Atom with Sulfonamide.  Give me five molecules in SMILES only and list them using bullet points. No explanation is needed. '}, {'role': 'assistant', 'content': ' * O=C(Nc1sc2c(c1C(N)=O)CN(C(=O)OCC)CC2)c1ccc2c(c1)OCCO2\n* O=C(Nc1sc2c(c1C(N)=O)CN(S(=O)(=O)CC(C)(C)C)CC2)c1ccc2c(c1)OCCO2\n* O=C(Nc1sc2c(c1C(N)=O)CN(S(=O)(=O)c1ccc(C)cc1)CC2)c1ccc2c(c1)OCCO2\n* O=C(Nc1sc2c(c1C(N)=O)CN(S(=O)(=O)c1ccc(C(F)(F)F)cc1)CC2)c1ccc2c(c1)OCCO2\n* O=C(Nc1sc2c(c1C(N)=O)CN(S(=O)(=O)N1CCCCC1)CC2)c1ccc2c(c1)OCCO2'}, {'role': 'user', 'content': 'Your provided sequence O=C(Nc1sc2c(c1C(N)=O)CN(C(=O)OCC)CC2)c1ccc2c(c1)OCCO2 could not achieve goal. You are suggested to edit the molecule according to the suggestion: You are suggested to do the modification according to the suggestion: Add a Guanidine. . Can you give me new molecules?'}]
AI answer 0: Sure, here are five new molecules with added guanidine groups:
* NC(=O)N1CCc2c(sc(NC(=O)c3ccc4c(c3)OCCO4)c2C(N)=O)C1
* NC(=O)N1CCc2c(sc(NC(=O)c3ccc4c(c3)OCCO4)c2C(N)=O)C1N=C(N)N
* N=C(N)N1CCc2c(sc(NC(=O)c3ccc4c(c3)OCCO4)c2C(N)=O)C1
* NC(=O)N1CCc2c(sc(NC(=O)c3ccc4c(c3)OCCO4)c2C(N)=O)N(C(N)=O)C1
* NC(=O)N1CCc2c(sc(NC(=O)c3ccc4c(c3)OCCO4)c2C(N)=O)N(C(=N)N)C1
Acc = 6/6
Hit Ratio = 6/6
----------------
>>Sample 6
RL Suggestion 0: Replace Chloroalkane with Aliphatic Amine. 
Message 0: [{'role': 'system', 'content': 'You are a helpful chemistry expert with extensive knowledge of drug design. '}, {'role': 'user', 'content': 'Can you make molecule Fc1ccccc1N1CCN(c2ncc(Cl)cc2F)CC1 more soluble in water? The output molecule should be similar to the input molecule. You are suggested to do the modification according to the suggestion: Replace Chloroalkane with Aliphatic Amine.  Give me five molecules in SMILES only and list them using bullet points. No explanation is needed. '}]
AI answer 0:  * Fc1ccccc1N1CCN(c2ncc(Cl)cc2F)CC1
* Fc1cc(Cl)cn2c1CNCC2
* Fc1cc(Cl)cn2c1CN(c1ccccc1F)CC2
* Fc1cc(Cl)cn2c1CN(CCO)CC2
* Fc1cc(Cl)cn2c1CN(CCNCc1ccco1)CC2
All nodes in last layer is invalid, Tree search process ends.
Acc = 6/7
Hit Ratio = 6/6
----------------
>>Sample 7
RL Suggestion 0: Replace Carbon Atom with Sulfonamide. 
Message 0: [{'role': 'system', 'content': 'You are a helpful chemistry expert with extensive knowledge of drug design. '}, {'role': 'user', 'content': 'Can you make molecule CNC(=O)CSc1ncnc2sc(C)c(C)c12 more soluble in water? The output molecule should be similar to the input molecule. You are suggested to do the modification according to the suggestion: Replace Carbon Atom with Sulfonamide.  Give me five molecules in SMILES only and list them using bullet points. No explanation is needed. '}]
AI answer 0:  * Cc1ncnc2sc(SCC(=O)NC)c(C)c12
RL Suggestion 0: Add a Guanidine. 
Message 0: [{'role': 'system', 'content': 'You are a helpful chemistry expert with extensive knowledge of drug design. '}, {'role': 'user', 'content': 'Can you make molecule CNC(=O)CSc1ncnc2sc(C)c(C)c12 more soluble in water? The output molecule should be similar to the input molecule. You are suggested to do the modification according to the suggestion: Replace Carbon Atom with Sulfonamide.  Give me five molecules in SMILES only and list them using bullet points. No explanation is needed. '}, {'role': 'assistant', 'content': ' * Cc1ncnc2sc(SCC(=O)NC)c(C)c12'}, {'role': 'user', 'content': 'Your provided sequence Cc1ncnc2sc(SCC(=O)NC)c(C)c12 could not achieve goal. You are suggested to edit the molecule according to the suggestion: You are suggested to do the modification according to the suggestion: Add a Guanidine. . Can you give me new molecules?'}]
AI answer 0: * Cc1nc(N=C(N)N)nc2sc(SCC(=O)NC)c(C)c12
Acc = 7/8
Hit Ratio = 7/7
----------------
>>Sample 8
RL Suggestion 0: Replace Carbon Atom with Sulfonamide. 
Message 0: [{'role': 'system', 'content': 'You are a helpful chemistry expert with extensive knowledge of drug design. '}, {'role': 'user', 'content': 'Can you make molecule COC(=O)c1cc2n(n1)CCN(c1cc(OC)nc(OC)n1)C2 more soluble in water? The output molecule should be similar to the input molecule. You are suggested to do the modification according to the suggestion: Replace Carbon Atom with Sulfonamide.  Give me five molecules in SMILES only and list them using bullet points. No explanation is needed. '}]
AI answer 0:  * COC(=O)c1cc2n(n1)CCN(c1cc(OC)nc(OC)n1)C2
* COC(=O)c1c(N(C)c2cc(OC)nc(OC)n2)c2n[nH]c(C)c2n1
* COC(=O)c1c(NS(=O)(=O)c2ccccc2)c2n[nH]c(C)c2n1
* COC(=O)c1c(NS(=O)(=O)c2ccc(C)cc2)c2n[nH]c(C)c2n1
* COC(=O)c1c(NS(=O)(=O)c2ccc(F)cc2)c2n[nH]c(C)c2n1
All nodes in last layer is invalid, Tree search process ends.
Acc = 7/9
Hit Ratio = 7/7
----------------
>>Sample 9
RL Suggestion 0: Replace Fluorine Atom with Cyano. 
Message 0: [{'role': 'system', 'content': 'You are a helpful chemistry expert with extensive knowledge of drug design. '}, {'role': 'user', 'content': 'Can you make molecule O=C(N[C@@H](c1ccccc1)C1CC1)N1CCC(OCc2ccccc2F)CC1 more soluble in water? The output molecule should be similar to the input molecule. You are suggested to do the modification according to the suggestion: Replace Fluorine Atom with Cyano.  Give me five molecules in SMILES only and list them using bullet points. No explanation is needed. '}]
AI answer 0:  *O=C(N[C@@H](c1ccccc1)C1CC1)N1CCC(OCc2ccccc2C#N)CC1
*O=C(N[C@@H](c1ccccc1)C1CC1)N1CCC(OCc2cccc(C#N)c2)CC1
*O=C(N[C@@H](c1ccccc1)C1CC1)N1CCC(OCc2ccc(C#N)cc2F)CC1
*O=C(N[C@@H](c1ccccc1)C1CC1)N1CCC(OCc2ccc(C#N)cc2)CC1
*O=C(N[C@@H](c1ccccc1)C1CC1)N1CCC(OCc2cc(C#N)cc(C(F)(F)F)c2)CC1
Acc = 8/10
Hit Ratio = 8/8
----------------
--------Final Acc--------
Acc = 8/10
Hit Ratio = 8/8
----------------
